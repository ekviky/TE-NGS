# TE-NGS: TE calls from targeted TE-enriched NGS data

Contents
--------
This distribution contains the following subdirectories:

/scripts 
TE calling implemented in R 
	R_get_TE_calls_v0.1.r 

/annotations 
Contains local copies all input TE annotations, reference annotations, primer sequences, etc 
# NB: gzipped files for size limit on GitHub need to be extracted
	gw_TE_targets_window3flank600bp.interval
	hg19_RM_allLINESINE_window3flank600bp.interval
	hg19_access_custom2.bed
	hg19_centroTelo_sorted.txt
	phase3_20130502_NA12878_present_window3flank600bp.interval
	polyTEdb_window3flank600bp.interval
	P3_primers.txt


/test 
Contains files necessary for implementation and unit testing
	seq_opt_table.txt # input file describing experimental design 
	input bams NA12878 # chr1 only
	cluster output files for NA12878 to compare output
	annotated cluster files for NA12878 for comparison/unit testing

/examples
Contains example output files
	NA12878_TE-NGS_calls_annotated_v0.1.bed # all TE calls made for NA12878 and results described in manuscript

Requirements
------------

TE-NGS is implemented in R and distributed using packrat for management of packages, dependencies, etc. The snapshot is built on R version 3.1.2. 

The R script requires the following inputs:
	seq_opt_table.txt # a file describing the experimental conditions per sample, eg sample ID, index, primer
	path to bam directory # a directory containing bam(s) generated by TE-NGS workflow
	cluster distance (bp) # minimum distance required between neighboring genomic clusters, 201 recommended
	mode # one of [test,sample] indicating the run mode: test to generate TE calls on NA12878 bams provided in /test; sample for generating TE calls on new sample
	
Implementation
--------------
# tested on WTCHG rescomp and florence/dougal/dylan 
# run no arguments to see usage
$ cd scripts
$ module load R/3.1.2
$ R --no-restore --no-save --no-readline --quiet < R_get_TE_calls_v0.1.r --args ../test/ ../test/seq_opt_table.txt 201 test
